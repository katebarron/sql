<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>SQL Queries in Redivis: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav software"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Software Carpentry" src="assets/images/software-logo.svg">
</div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav software" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Software Carpentry" src="assets/images/software-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      SQL Queries in Redivis
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            SQL Queries in Redivis
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  SQL Queries in Redivis
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress software">
    <div class="progress-bar software" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-select.html">1. Selecting Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-sort-dup.html">2. Sorting and Removing Duplicates</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-filter.html">3. Filtering</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-calc.html">4. Calculating New Values</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-null.html">5. Missing Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-agg.html">6. Aggregation</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-join.html">7. Combining Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li>
<li><a href="reference.html">Glossary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-select"><p>Content from <a href="01-select.html">Selecting Data</a></p>
<hr>
<p>Last updated on 2023-10-05 |
        
        <a href="https://github.com/swcarpentry/sql-novice-survey/edit/main/episodes/01-select.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I get data from a database?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Write a query to select all values for specific fields from a single
table.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>A <a href="reference.html#relational-database">relational
database</a> is a way to store and manipulate information. Databases are
arranged as <a href="reference.html#table">tables</a>. Each table has
columns (also known as <a href="reference.html#fields">fields</a>) that
describe the data, and rows (also known as <a href="reference.html#record">records</a>) which contain the data.</p>
<p>When we are using a spreadsheet, we put formulas into cells to
calculate new values based on old ones. When we are using a database, we
send commands (usually called <a href="reference.html#query">queries</a>) to a <a href="reference.html#database-manager">database manager</a>: a program
that manipulates the database for us. The database manager does whatever
lookups and calculations the query specifies, returning the results in a
tabular form that we can then use as a starting point for further
queries.</p>
<p>Queries are written in a language called <a href="reference.html#sql">SQL</a>, which stands for “Structured Query
Language”. SQL provides hundreds of different ways to analyze and
recombine data. We will only look at a handful of queries, but that
handful accounts for most of what scientists do.</p>
<p>Let’s take a look at the tables of the database we will use in our
examples.</p>
<p>In your Redivis project, select the database node.</p>
<figure><img src="fig/02.1_database_node.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>On the right-hand side of the page, we will see that there are 5
tables associated with this database:</p>
<ul>
<li><code>Countries</code></li>
<li><code>Daily observations</code></li>
<li><code>Inventory</code></li>
<li><code>States</code></li>
<li><code>Stations</code></li>
</ul>
<p>Let’s select <code>Stations</code>.</p>
<figure><img src="fig/02.2_select_stations.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>The <code>Stations</code> table includes information about each
station. The <strong>Variables</strong> tab shows us 10 variables and
their types.</p>
<figure><img src="fig/02.3_variables_tab.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>We can select specific variables for summary statistics about that
variable. Let’s select <code>state</code>. Under <strong>Variable
statistics</strong> we can learn more about this variable, such as the
frequency with which certain values occur and the number of distinct
(unique) values. Note that the <code>state</code> variable is 100%
non-null. We’ll return to these missing values <a href="05-null.html">later</a>.</p>
<figure><img src="fig/02.4_summary_statistics.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Finally, we can select the <strong>Cells</strong> tab to preview
records.</p>
<figure><img src="fig/02.5_cells_tab.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Let’s write an SQL query that displays station names and what state
the stations are located in.</p>
<p>Select the <strong>Transform</strong> node. Transform nodes are where
we will write our SQL queries.</p>
<figure><img src="fig/02.6_transform_node.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Select <strong>New step</strong> and then <strong>SQL query</strong>.
A query editor will display on the right side of the page; it will be
populated with a default query.</p>
<figure><img src="fig/02.7_new_step.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/02.8_transform_query_editor.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Now we will write a SQL <code>SELECT</code> command, giving it the
names of the columns we want and the table we want them from. Our query
will look like this:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> state, name <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<p>Select <strong>Run</strong> in the upper right-hand corner. Then
select the output table node. Here we can see the results of the
query.</p>
<figure><img src="fig/02.9_run.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/02.10_output_table_node.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div id="table-name" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="table-name" class="callout-inner">
<h3 class="callout-title">Table Name<a class="anchor" aria-label="anchor" href="#table-name"></a>
</h3>
<div class="callout-content">
<p>In the Redivis SQL query editor, the table we are working with is
given the alias <code>_source_</code>.</p>
</div>
</div>
</div>
<div id="semi-colon" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="semi-colon" class="callout-inner">
<h3 class="callout-title">Semi-Colon<a class="anchor" aria-label="anchor" href="#semi-colon"></a>
</h3>
<div class="callout-content">
<p>Generally, database managers expect a semicolon at the end of a
query. This tells the database manager that the query is complete and
ready to run. In Redivis, semicolons aren’t required at the end of a
query, but it’s a good practice to use them.</p>
</div>
</div>
</div>
<p>We have written our commands in upper case and the names for the
table and columns in lower case, but we don’t have to: as the example
below shows, SQL is <a href="reference.html#case-insensitive">case
insensitive</a>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SeLeCt</span> StAtE,nAmE <span class="kw">FrOm</span> _source_</span></code></pre>
</div>
<figure><img src="fig/02.11_case_insensitive_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/02.12_case_insensitive_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>You can use SQL’s case insensitivity to distinguish between different
parts of an SQL statement. In this lesson, we use the convention of
using UPPER CASE for SQL keywords (such as <code>SELECT</code> and
<code>FROM</code>), and lower case for field names. Whatever casing
convention you choose, please be consistent: complex queries are hard
enough to read without the extra cognitive load of random
capitalization.</p>
<p>Now, going back to our query, it’s important to understand that the
rows and columns in a database table aren’t actually stored in any
particular order. They will always be <em>displayed</em> in some order,
but we can control that in various ways. For example, we could swap the
columns in the output by writing our query as:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> name,state <span class="kw">FROM</span> _source_</span></code></pre>
</div>
<figure><img src="fig/02.13_reverse_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/02.14_reverse_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>As a shortcut, we can select all of the columns in a table using
<code>*</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_</span></code></pre>
</div>
<figure><img src="fig/02.15_select_all_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/02.16_select_all_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div id="integers-vs.-floats" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="integers-vs.-floats" class="callout-inner">
<h3 class="callout-title">Integers vs. Floats<a class="anchor" aria-label="anchor" href="#integers-vs.-floats"></a>
</h3>
<div class="callout-content">
<p>In the <code>Stations</code> table, there are two numeric data types:
integers and floats. Which variables are integers? Which are floats?
What is the difference between integers and floats?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Integers:</p>
<ul>
<li><code>wmoid</code></li>
</ul>
<p>Floats:</p>
<ul>
<li><code>latitude</code></li>
<li><code>longitude</code></li>
<li><code>elevation</code></li>
</ul>
<p>Integers are whole numbers. Floats are numbers with decimal
places.</p>
</div>
</div>
</div>
</div>
<div id="selecting-geopoints" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="selecting-geopoints" class="callout-inner">
<h3 class="callout-title">Selecting Geopoints<a class="anchor" aria-label="anchor" href="#selecting-geopoints"></a>
</h3>
<div class="callout-content">
<p>Write a query that selects only the <code>geopoint</code> column from
the <code>Stations</code> table.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> geopoint <span class="kw">FROM</span> _source_</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="query-style" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="query-style" class="callout-inner">
<h3 class="callout-title">Query Style<a class="anchor" aria-label="anchor" href="#query-style"></a>
</h3>
<div class="callout-content">
<p>Many people format queries as:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> personal, family <span class="kw">FROM</span> person;</span></code></pre>
</div>
<p>or as:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> Personal, Family <span class="kw">from</span> PERSON;</span></code></pre>
</div>
<p>What style do you find easiest to read, and why?</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>A relational database stores information in tables, each of which
has a fixed set of columns and a variable number of records.</li>
<li>A database manager is a program that manipulates information stored
in a database.</li>
<li>We write queries in a specialized language called SQL to extract
information from databases.</li>
<li>Use SELECT… FROM… to get values from a database table.</li>
<li>SQL is case-insensitive (but data is case-sensitive).</li>
</ul>
</div>
</div>
</div></section><section id="aio-02-sort-dup"><p>Content from <a href="02-sort-dup.html">Sorting and Removing Duplicates</a></p>
<hr>
<p>Last updated on 2023-10-10 |
        
        <a href="https://github.com/swcarpentry/sql-novice-survey/edit/main/episodes/02-sort-dup.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I sort a query’s results?</li>
<li>How can I remove duplicate values from a query’s results?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Write queries that display results in a particular order.</li>
<li>Write queries that eliminate duplicate values from data.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In beginning our examination of the GHCN Daily Weather Data, we want
to know:</p>
<ul>
<li>what kind of elements (observation types) were taken at each
station;</li>
<li>when did these observations occur;</li>
</ul>
<p>To determine which kinds of observations were taken, we can examine
the <code>Daily observations</code> table. Data is often redundant, so
queries often return redundant information. For example, if we select
the observation types that have been measured from the
<code>Daily observations</code> table, we get this:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> element <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<figure><img src="fig/03.1_select_element_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/03.2_select_element_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>This result makes it difficult to see all of the different types of
<code>elements</code> in the <code>Daily observations</code> table. We
can eliminate the redundant output to make the result more readable by
adding the <code>DISTINCT</code> keyword to our query:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> element <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<figure><img src="fig/03.3_select_element_distinct_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/03.4_select_element_distinct_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>If we want to determine the stations (represented by <code>id</code>)
at which different observation types were recorded, we can use the
<code>DISTINCT</code> keyword on multiple columns. If we select more
than one column, distinct <em>sets</em> of values are returned (in this
case <em>pairs</em>, because we are selecting two columns):</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="kw">id</span>, element <span class="kw">FROM</span>  _source_;</span></code></pre>
</div>
<figure><img src="fig/03.5_two_distinct_variables_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/03.6_two_distinct_variables_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Our next task is to identify when weather observations occurred. As
we mentioned earlier, database records are not stored in any particular
order. This means that query results aren’t necessarily sorted, and even
if they are, we often want to sort them in a different way, e.g., by
date. We can do this in SQL by adding an <code>ORDER BY</code> clause to
our query:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">ORDER</span> <span class="kw">BY</span> <span class="dt">date</span>;</span></code></pre>
</div>
<figure><img src="fig/03.7_order_by_date_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/03.8_order_by_date_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>By default, when we use <code>ORDER BY</code>, results are sorted in
ascending order of the column we specify (i.e., from least to
greatest).</p>
<div id="a-note-on-ordering" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="a-note-on-ordering" class="callout-inner">
<h3 class="callout-title">A note on ordering<a class="anchor" aria-label="anchor" href="#a-note-on-ordering"></a>
</h3>
<div class="callout-content">
<p>While it may look that the records are consistent every time we ask
for them in this lesson, that is because no one has changed or modified
any of the data so far. Remember to use <code>ORDER BY</code> if you
want the rows returned to have any sort of consistent or predictable
order.</p>
</div>
</div>
</div>
<div id="date-types" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="date-types" class="callout-inner">
<h3 class="callout-title">Date Types<a class="anchor" aria-label="anchor" href="#date-types"></a>
</h3>
<div class="callout-content">
<p>Most database managers have a special data type for dates. In fact,
many have two: one for dates, such as “May 31, 1971”, and one for
durations, such as “31 days”. Redivis stores <a href="https://docs.redivis.com/reference/datasets/tables/variables#date" class="external-link">Dates</a>
and <a href="https://docs.redivis.com/reference/datasets/tables/variables#datetime" class="external-link">DateTimes</a>.
The former is formatted as ‘YYYY-[M]M-[D]D’:</p>
<ul>
<li>YYYY: Four digit year</li>
<li>[M]M: One or two digit month</li>
<li>[D]D: One or two digit day</li>
</ul>
<p>The latter is formatted as ‘YYYY-[M]M-[D]D[(
|T)[H]H:[M]M:[S]S[.DDDDDD]]’:</p>
<ul>
<li>YYYY: Four digit year</li>
<li>[M]M: One or two digit month</li>
<li>[D]D: One or two digit day</li>
<li>( |T): A space or a Tseparator</li>
<li>[H]H: One or two digit hour (valid values from 00 to 23)</li>
<li>[M]M: One or two digit minutes (valid values from 00 to 59)</li>
<li>[S]S: One or two digit seconds (valid values from 00 to 59)</li>
<li>[.DDDDDD]: Up to six fractional digits (i.e. up to microsecond
precision)</li>
</ul>
</div>
</div>
</div>
<p>We can sort in the opposite order using <code>DESC</code> (for
“descending”):</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">ORDER</span> <span class="kw">BY</span> <span class="dt">date</span> <span class="kw">DESC</span>;</span></code></pre>
</div>
<figure><img src="fig/03.9_order_by_date_desc_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/03.10_order_by_date_desc_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>(And if we want to make it clear that we’re sorting in ascending
order, we can use <code>ASC</code> instead of <code>DESC</code>.)</p>
<p>If we want a more complete picture of when weather observations took
place, we can sort on several fields at once. This query sorts results
first in descending order by <code>date</code>, and then in ascending
order by <code>time</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">id</span>, element, <span class="dt">date</span>, <span class="dt">time</span> <span class="kw">FROM</span> _source_ <span class="kw">ORDER</span> <span class="kw">BY</span> <span class="dt">date</span> <span class="kw">DESC</span>, <span class="dt">time</span> <span class="kw">ASC</span>;</span></code></pre>
</div>
<figure><img src="fig/03.11_order_by_date_time_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/03.12_order_by_date_time_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div id="finding-distinct-dates" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="finding-distinct-dates" class="callout-inner">
<h3 class="callout-title">Finding Distinct Dates<a class="anchor" aria-label="anchor" href="#finding-distinct-dates"></a>
</h3>
<div class="callout-content">
<p>Write a query that selects distinct dates from the
<code>Daily observations</code> table.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="dt">date</span> <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<figure><img src="fig/03.13_distinct_dates_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/03.14_distinct_dates_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure>
</div>
</div>
</div>
</div>
<div id="displaying-station-names-and-locations" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="displaying-station-names-and-locations" class="callout-inner">
<h3 class="callout-title">Displaying Station Names and Locations<a class="anchor" aria-label="anchor" href="#displaying-station-names-and-locations"></a>
</h3>
<div class="callout-content">
<p>Using the <code>Stations</code> table, write a query that displays
the names of stations and the states where they are located. The output
should be sorted alphabetically first by state, and then by name.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> state, name <span class="kw">FROM</span> _source_ <span class="kw">ORDER</span> <span class="kw">BY</span> state <span class="kw">ASC</span>, name <span class="kw">ASC</span>;</span></code></pre>
</div>
<figure><img src="fig/03.15_alphabetical_name_state_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/03.16_alphabetical_name_state_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The records in a database table are not intrinsically ordered: if we
want to display them in some order, we must specify that explicitly with
ORDER BY.</li>
<li>The values in a database are not guaranteed to be unique: if we want
to eliminate duplicates, we must specify that explicitly as well using
DISTINCT.</li>
</ul>
</div>
</div>
</div></section><section id="aio-03-filter"><p>Content from <a href="03-filter.html">Filtering</a></p>
<hr>
<p>Last updated on 2023-10-10 |
        
        <a href="https://github.com/swcarpentry/sql-novice-survey/edit/main/episodes/03-filter.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I select subsets of data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Write queries that select records that satisfy user-specified
conditions.</li>
<li>Explain the order in which the clauses in a query are executed.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>One of the most powerful features of a database is the ability to <a href="reference.html#filter">filter</a> data, i.e., to select only those
records that match certain criteria. For example, suppose we want to see
all of the stations in Texas. We can select these records from the
<code>Stations</code> table by using a <code>WHERE</code> clause in our
query:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> state <span class="op">=</span> <span class="st">'TX'</span>;</span></code></pre>
</div>
<figure><img src="fig/04.1_where_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.2_where_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>The database manager executes this query in two stages. First, it
checks at each row in the <code>Station</code> table to see which ones
satisfy the <code>WHERE</code>. It then uses the column names following
the <code>SELECT</code> keyword to determine which columns to
display.</p>
<p>This processing order means that we can filter records using
<code>WHERE</code> based on values in columns that aren’t then
displayed:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">id</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> state <span class="op">=</span> <span class="st">'TX'</span>;</span></code></pre>
</div>
<figure><img src="fig/04.3_where_column_values_not_displayed_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.4_where_column_values_not_displayed_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>We can use many other Boolean operators to filter our data. For
example, we can ask for all information from the stations at elevations
less than 50 meters:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_  <span class="kw">WHERE</span> state <span class="op">=</span> <span class="st">'TX'</span> <span class="kw">AND</span> elevation <span class="op">&lt;</span> <span class="dv">50</span>;</span></code></pre>
</div>
<figure><img src="fig/04.5_where_other_bools_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.6_where_other_bools_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>If we want to find stations in either Texas or Oklahoma, we can
combine the tests on their names using <code>OR</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_  <span class="kw">WHERE</span> state <span class="op">=</span> <span class="st">'TX'</span> <span class="kw">OR</span> state <span class="op">=</span> <span class="st">'OK'</span>;</span></code></pre>
</div>
<figure><img src="fig/04.7_where_or_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.8_where_or_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Alternatively, we can use <code>IN</code> to see if a value is in a
specific set:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_  <span class="kw">WHERE</span> state <span class="kw">IN</span> (<span class="st">'TX'</span>, <span class="st">'OK'</span>);</span></code></pre>
</div>
<figure><img src="fig/04.9_where_set_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.10_where_set_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>We can combine <code>AND</code> with <code>OR</code>, but we need to
be careful about which operator is executed first. If we <em>don’t</em>
use parentheses, we get this:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> elevation <span class="op">&lt;</span> <span class="dv">50</span> <span class="kw">AND</span> state <span class="op">=</span> <span class="st">'TX'</span> <span class="kw">OR</span> state <span class="op">=</span> <span class="st">'OK'</span>;</span></code></pre>
</div>
<p>which is stations from Texas at less than 50 meters elevation, and
<em>any</em> stations from Oklahoma.</p>
<figure><img src="fig/04.11_where_incorrect_logic.query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.12_where_incorrect_logic.output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>We probably want this instead:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> elevation <span class="op">&lt;</span> <span class="dv">50</span> <span class="kw">AND</span> (state <span class="op">=</span> <span class="st">'TX'</span> <span class="kw">OR</span> state <span class="op">=</span> <span class="st">'OK'</span>);</span></code></pre>
</div>
<figure><img src="fig/04.13_where_correct_logic_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.14_where_correct_logic_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>We can also filter by partial matches. For example, if we want to
know something just about the station ids beginning with “MD” we can use
the <code>LIKE</code> keyword. The percent symbol acts as a <a href="reference.html#wildcard">wildcard</a>, matching any characters in
that place. It can be used at the beginning, middle, or end of the
string:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="kw">id</span> <span class="kw">LIKE</span> <span class="st">'MD%'</span>;</span></code></pre>
</div>
<figure><img src="fig/04.15_where_like_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.16_where_like_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Finally, we can use <code>DISTINCT</code> with <code>WHERE</code> to
give a second level of filtering. Let’s look at an example using the
<code>Daily observations</code> table :</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="kw">id</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'SNOW'</span>;</span></code></pre>
</div>
<figure><img src="fig/04.17_where_distinct_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/04.18_where_distinct_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>But remember: <code>DISTINCT</code> is applied to the values
displayed in the chosen columns, not to the entire rows as they are
being processed.</p>
<div id="growing-queries" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="growing-queries" class="callout-inner">
<h3 class="callout-title">Growing Queries<a class="anchor" aria-label="anchor" href="#growing-queries"></a>
</h3>
<div class="callout-content">
<p>What we have just done is how most people “grow” their SQL queries.
We started with something simple that did part of what we wanted, then
added more clauses one by one, testing their effects as we went. This is
a good strategy — in fact, for complex queries it’s often the
<em>only</em> strategy — but it depends on quick turnaround, and on us
recognizing the right answer when we get it.</p>
<p>The best way to achieve a quick turnaround is often to put a subset
of data in a temporary database and run our queries against that, or to
fill a small database with synthesized records. For example, instead of
trying our queries against an actual database of 20 million Australians,
we could run it against a sample of ten thousand, or write a small
program to generate ten thousand random (but plausible) records and use
that.</p>
</div>
</div>
</div>
<div id="fix-this-query" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="fix-this-query" class="callout-inner">
<h3 class="callout-title">Fix This Query<a class="anchor" aria-label="anchor" href="#fix-this-query"></a>
</h3>
<div class="callout-content">
<p>Suppose we want to select all stations that lie within 30 degrees of
the equator. Our first query is:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_  <span class="kw">WHERE</span> (latitude <span class="op">&gt;</span> <span class="op">-</span><span class="dv">30</span>) <span class="kw">OR</span> (latitude <span class="op">&lt;</span> <span class="dv">30</span>);</span></code></pre>
</div>
<p>Explain why this is wrong, and rewrite the query so that it is
correct.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Because we used <code>OR</code>, a site on the South Pole for example
will still meet the second criteria and thus be included. Instead, we
want to restrict this to sites that meet <em>both</em> criteria:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_  <span class="kw">WHERE</span> (latitude <span class="op">&gt;</span> <span class="op">-</span><span class="dv">30</span>) <span class="kw">AND</span> (latitude <span class="op">&lt;</span> <span class="dv">30</span>);</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="finding-outliers" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="finding-outliers" class="callout-inner">
<h3 class="callout-title">Finding Outliers<a class="anchor" aria-label="anchor" href="#finding-outliers"></a>
</h3>
<div class="callout-content">
<p>We see that some observations have negative values. Let’s make sure
these are not incorrect data. Using the the
<code>Daily observations</code> table, write a query that selects unique
observations with values less than 0. Then, look up these observation
types in the <a href="https://www.ncei.noaa.gov/data/global-historical-climatology-network-daily/doc/GHCND_documentation.pdf" class="external-link">GHCND
Documentation</a>. Is it possible for these observation types to have
negative values?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> element <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="fu">value</span> <span class="op">&lt;</span> <span class="dv">0</span>;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>element</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>TAVG</td>
</tr>
<tr class="even">
<td>SX32</td>
</tr>
<tr class="odd">
<td>SN52</td>
</tr>
<tr class="even">
<td>TMIN</td>
</tr>
<tr class="odd">
<td>SX02</td>
</tr>
<tr class="even">
<td>SN32</td>
</tr>
<tr class="odd">
<td>MNPN</td>
</tr>
<tr class="even">
<td>TMAX</td>
</tr>
<tr class="odd">
<td>EVAP</td>
</tr>
<tr class="even">
<td>TOBS</td>
</tr>
<tr class="odd">
<td>MXPN</td>
</tr>
<tr class="even">
<td>DAPR</td>
</tr>
<tr class="odd">
<td>MDTN</td>
</tr>
<tr class="even">
<td>SN02</td>
</tr>
</tbody>
</table>
<p>At least for some of these observations, negative values seem
possible. For example, TOBS is temperature at the time of observation.
Temperatures can in fact be negative.</p>
</div>
</div>
</div>
</div>
<div id="matching-patterns" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="matching-patterns" class="callout-inner">
<h3 class="callout-title">Matching Patterns<a class="anchor" aria-label="anchor" href="#matching-patterns"></a>
</h3>
<div class="callout-content">
<p>Which of these expressions are true?</p>
<ol style="list-style-type: decimal">
<li><code>'a' LIKE 'a'</code></li>
<li><code>'a' LIKE '%a'</code></li>
<li><code>'beta' LIKE '%a'</code></li>
<li><code>'alpha' LIKE 'a%%'</code></li>
<li><code>'alpha' LIKE 'a%p%'</code></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>True because these are the same character.</li>
<li>True because the wildcard can match <em>zero</em> or more
characters.</li>
<li>True because the <code>%</code> matches <code>bet</code> and the
<code>a</code> matches the <code>a</code>.</li>
<li>True because the first wildcard matches <code>lpha</code> and the
second wildcard matches zero characters (or vice versa).</li>
<li>True because the first wildcard matches <code>l</code> and the
second wildcard matches <code>ha</code>.</li>
</ol>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use WHERE to specify conditions that records must meet in order to
be included in a query’s results.</li>
<li>Use AND, OR, and NOT to combine tests.</li>
<li>Filtering is done on whole records, so conditions can use fields
that are not actually displayed.</li>
<li>Write queries incrementally.</li>
</ul>
</div>
</div>
</div></section><section id="aio-04-calc"><p>Content from <a href="04-calc.html">Calculating New Values</a></p>
<hr>
<p>Last updated on 2023-10-10 |
        
        <a href="https://github.com/swcarpentry/sql-novice-survey/edit/main/episodes/04-calc.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I calculate new values on the fly?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Write queries that calculate new values for each selected
record.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We realize that the reported precipitation measurements may need to
be corrected upward by 5%. Rather than modifying the stored data, we can
do this calculation on the fly as part of our query:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">value</span> <span class="kw">AS</span> original_value, <span class="fu">value</span> <span class="op">*</span> <span class="fl">1.05</span> <span class="kw">AS</span> updated_value <span class="kw">FROM</span> _source_ </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> element <span class="op">=</span> <span class="ot">"PRCP"</span> <span class="kw">AND</span> <span class="fu">value</span> <span class="op">&gt;</span> <span class="dv">0</span>;</span></code></pre>
</div>
<p>When we run the query, the expression <code>value * 1.05</code> is
evaluated for each row where the element is precipitation and the
measurement is greater than 0.</p>
<figure><img src="fig/05.1_calculation_5_percent_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/05.2_calculation_5_percent_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div id="renaming-variables" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="renaming-variables" class="callout-inner">
<h3 class="callout-title">Renaming variables<a class="anchor" aria-label="anchor" href="#renaming-variables"></a>
</h3>
<div class="callout-content">
<p>We can use the keyword <code>AS</code> to rename the variables in our
output. SQL allows us to rename our fields, any field for that matter,
whether it was calculated or one of the existing fields in our database,
for succinctness and clarity. In Redivis, we <strong>must</strong>
rename calculated variables, or Redivis will throw an error.</p>
</div>
</div>
</div>
<p>Expressions can use any of the fields, all of usual arithmetic
operators, and a variety of common functions. (Exactly which ones
depends on which database manager is being used.) For example, we can
convert average temperature readings from Celsius to Fahrenheit and
round to one decimal place:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">value</span> <span class="kw">AS</span> celsius, <span class="fu">round</span>(<span class="fu">value</span> <span class="op">*</span> <span class="dv">9</span><span class="op">/</span><span class="dv">5</span> <span class="op">+</span> <span class="dv">32</span>,<span class="dv">1</span>) <span class="kw">AS</span> fahrenheit </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'TAVG'</span> <span class="kw">AND</span> <span class="fu">value</span> <span class="op">&gt;</span> <span class="dv">0</span>;</span></code></pre>
</div>
<figure><img src="fig/05.3_celsius_farenheit_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/05.4_celsius_farenheit_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>We can also combine values from different fields, for example by
using the string concatenation operator <code>||</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="dt">date</span> <span class="op">||</span> <span class="st">': '</span> <span class="op">||</span> <span class="dt">time</span>  <span class="kw">AS</span> date_time <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<figure><img src="fig/05.5_string_concat_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/05.6_string_concat_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div id="converting-units-of-measurement" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="converting-units-of-measurement" class="callout-inner">
<h3 class="callout-title">Converting units of measurement<a class="anchor" aria-label="anchor" href="#converting-units-of-measurement"></a>
</h3>
<div class="callout-content">
<p>The average daily wind speed is measured in tenths of meters per
second. Write a query that returns wind speed in tenths of meters per
minute from the <code>Daily observations</code> table.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">value</span> <span class="kw">AS</span> per_second, (<span class="fu">value</span> <span class="op">*</span> <span class="dv">60</span>) <span class="kw">AS</span> per_minute <span class="kw">FROM</span> _source_ </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'AWND'</span> <span class="kw">AND</span> <span class="fu">value</span> <span class="op">&gt;</span><span class="dv">0</span>;</span></code></pre>
</div>
<figure><img src="fig/05.7_second_to_minute_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/05.8_second_to_minute_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure>
</div>
</div>
</div>
</div>
<div id="unions" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="unions" class="callout-inner">
<h3 class="callout-title">Unions<a class="anchor" aria-label="anchor" href="#unions"></a>
</h3>
<div class="callout-content">
<p>The <code>UNION ALL</code> operator combines the results of two
queries. <code>UNION ALL</code> will not eliminate duplicate rows.</p>
<p>The <code>UNION DISTINCT</code> operator also combines the results of
two queries, and then does a <code>SELECT DISTINCT</code> on the results
set.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'AWND'</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">UNION</span> <span class="kw">DISTINCT</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span>;</span></code></pre>
</div>
<figure><img src="fig/05.9_union_all_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/05.10_union_all_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure>
</div>
</div>
</div>
<div id="selecting-major-site-identifiers" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="selecting-major-site-identifiers" class="callout-inner">
<h3 class="callout-title">Selecting Major Site Identifiers<a class="anchor" aria-label="anchor" href="#selecting-major-site-identifiers"></a>
</h3>
<div class="callout-content">
<p>In the <code>Daily observations</code> table, <code>time</code> is
formatted as a string.</p>
<p>The substring function <code>substr(X, I, [L])</code> returns the
substring of X starting at index I, with an optional length L.</p>
<p>Use the substring function to return the hour daily observations were
made, sorted from greatest to smallest.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">SUBSTR</span>(<span class="dt">time</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="kw">AS</span> <span class="kw">hour</span> <span class="kw">FROM</span> _source_ <span class="kw">ORDER</span> <span class="kw">BY</span> <span class="kw">hour</span> <span class="kw">DESC</span>;</span></code></pre>
</div>
<figure><img src="fig/05.11_substring_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/05.12_substring_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Queries can do the usual arithmetic operations on values.</li>
<li>Use UNION to combine the results of two or more queries.</li>
</ul>
</div>
</div>
</div></section><section id="aio-05-null"><p>Content from <a href="05-null.html">Missing Data</a></p>
<hr>
<p>Last updated on 2023-10-10 |
        
        <a href="https://github.com/swcarpentry/sql-novice-survey/edit/main/episodes/05-null.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do databases represent missing information?</li>
<li>What special handling does missing information require?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how databases represent missing information.</li>
<li>Explain the three-valued logic databases use when manipulating
missing information.</li>
<li>Write queries that handle missing information correctly.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Real-world data is never complete — there are always holes. Databases
represent these holes using a special value called <code>null</code>.
<code>null</code> is not zero, <code>False</code>, or the empty string;
it is a one-of-a-kind value that means “nothing here”. Dealing with
<code>null</code> requires a few special tricks and some careful
thinking.</p>
<p>To start, let’s have a look at the <code>Daily observations</code>
table. If you look at the <code>time</code> variable frequency table,
there are 20,264,371 <code>null</code> values.</p>
<figure><img src="fig/06.1_time_nulls.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Null doesn’t behave like other values. If we select the records that
are less than “1200” we get 3,400,669 results.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">time</span> <span class="kw">from</span> _source_ <span class="kw">where</span> <span class="dt">time</span> <span class="op">&lt;</span> <span class="ot">"1200"</span>;</span></code></pre>
</div>
<figure><img src="fig/06.2_time_less_than_1200_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/06.3_time_less_than_1200_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>If we select the records that are greater than or equal to “1200” we
get 2,809,928 results.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">time</span> <span class="kw">from</span> _source_ <span class="kw">where</span> <span class="dt">time</span> <span class="op">&gt;=</span> <span class="ot">"1200"</span>;</span></code></pre>
</div>
<figure><img src="fig/06.4_time_greater_than_1200_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/06.5_time_greater_than_1200_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Why aren’t the <code>null</code> values appearing in the results
sets? The reason is that <code>null&lt;'1200'</code> and
<code>null&gt;='1200'</code> are neither true nor false: null means, “We
don’t know,” and if we don’t know the value on the left side of a
comparison, we don’t know whether the comparison is true or false. Since
databases represent “don’t know” as <code>null</code>, the values of
<code>null&lt;'1200'</code> and <code>null&gt;='1200'</code> are both
<code>null</code>. And since the only records kept by a
<code>WHERE</code> are those for which the test is true, the
<code>null</code> values aren’t included in either set of results.</p>
<p>To check whether a value is <code>null</code> or not, we must use a
special test <code>IS NULL</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">time</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="dt">time</span> <span class="kw">IS</span> <span class="kw">NULL</span>;</span></code></pre>
</div>
<figure><img src="fig/06.6_is_null_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/06.7_is_null_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>or its inverse <code>IS NOT NULL</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">time</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="dt">time</span> <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>;</span></code></pre>
</div>
<figure><img src="fig/06.8_is_not_null_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/06.9_is_not_null_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Null values can cause headaches wherever they appear. For example,
suppose we want to find all the measurements except for those taken at
“2400.” It’s natural to write the query like this:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="dt">time</span> <span class="op">!=</span> <span class="st">'2400'</span>;</span></code></pre>
</div>
<p>but this query filters omits the records where the time is unknown
(or <code>null</code>). Once again, the reason is that when
<code>time</code> is <code>null</code>, the <code>!=</code> comparison
produces <code>null</code>, so the <code>null</code> records aren’t kept
in our results.</p>
<figure><img src="fig/06.10_time_is_not_2400_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/06.11_time_is_not_2400_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>If we want to keep these records we need to add an explicit
check:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> (<span class="dt">time</span> <span class="op">!=</span> <span class="st">'2400'</span> <span class="kw">OR</span> <span class="dt">time</span> <span class="kw">IS</span> <span class="kw">NULL</span>);</span></code></pre>
</div>
<figure><img src="fig/06.12_time_not_2400_or_null_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/06.13_time_not_2400_or_null_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>We still have to decide whether this is the right thing to do or not.
If we want to be absolutely sure that we aren’t including any
measurements taken at ‘2400’ in our results, we need to exclude all the
records for which we don’t the time of the measurement.</p>
<p>In contrast to arithmetic or Boolean operators, aggregation functions
that combine multiple values, such as <code>min</code>, <code>max</code>
or <code>avg</code>, <em>ignore</em> <code>null</code> values. In the
majority of cases, this is a desirable output: for example, unknown
values are thus not affecting our data when we are averaging it.
Aggregation functions will be addressed in more detail in <a href="06-agg.html">the next section</a>.</p>
<div id="sorting-by-known-date" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="sorting-by-known-date" class="callout-inner">
<h3 class="callout-title">Sorting by Known Date<a class="anchor" aria-label="anchor" href="#sorting-by-known-date"></a>
</h3>
<div class="callout-content">
<p>Using the <code>Daily observations table</code>, generate a list of
unique qflags, omitting entries for which the qflag is not known (i.e.,
is null).</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> qflag <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> qflag <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>;</span></code></pre>
</div>
<figure><img src="fig/06.14_distinct_qflag_exclude_null_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/06.15_distinct_qflag_exclude_null_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure>
</div>
</div>
</div>
</div>
<div id="null-in-a-set" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="null-in-a-set" class="callout-inner">
<h3 class="callout-title">NULL in a Set<a class="anchor" aria-label="anchor" href="#null-in-a-set"></a>
</h3>
<div class="callout-content">
<p>What do you expect the following query to produce?</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="dt">time</span> <span class="kw">IN</span> (<span class="st">'2400'</span>, <span class="st">'2300'</span>, <span class="kw">NULL</span>);</span></code></pre>
</div>
<p>What does it actually produce?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>You might expect the above query to return rows where
<code>time</code> is either ‘2400’, ‘2300’ or NULL. Instead it only
returns rows where <code>time</code> is ‘2400’ or ‘2300’, the same as
you would get from this simpler query:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="dt">time</span> <span class="kw">IN</span> (<span class="st">'2400'</span>, <span class="st">'2300'</span>);</span></code></pre>
</div>
<p>The reason is that the <code>IN</code> operator works with a set of
<em>values</em>, but NULL is by definition not a value and is therefore
simply ignored.</p>
<p>If we wanted to actually include NULL, we would have to rewrite the
query to use the IS NULL condition:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="dt">time</span> <span class="kw">IN</span> (<span class="st">'2400'</span>, <span class="st">'2300'</span>) <span class="kw">OR</span> <span class="dt">time</span> <span class="kw">IS</span> <span class="kw">NULL</span>;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="pros-and-cons-of-sentinels" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="pros-and-cons-of-sentinels" class="callout-inner">
<h3 class="callout-title">Pros and Cons of Sentinels<a class="anchor" aria-label="anchor" href="#pros-and-cons-of-sentinels"></a>
</h3>
<div class="callout-content">
<p>Some database designers prefer to use a <a href="reference.html#sentinel-value">sentinel value</a> to mark missing
data rather than <code>null</code>. For example, they will use the date
“0000-00-00” to mark a missing date, or -1.0 to mark a missing salinity
or radiation reading (since actual readings cannot be negative). What
does this simplify? What burdens or risks does it introduce?</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Databases use a special value called NULL to represent missing
information.</li>
<li>Almost all operations on NULL produce NULL.</li>
<li>Queries can test for NULLs using IS NULL and IS NOT NULL.</li>
</ul>
</div>
</div>
</div></section><section id="aio-06-agg"><p>Content from <a href="06-agg.html">Aggregation</a></p>
<hr>
<p>Last updated on 2023-10-10 |
        
        <a href="https://github.com/swcarpentry/sql-novice-survey/edit/main/episodes/06-agg.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I calculate sums, averages, and other summary values?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Define aggregation and give examples of its use.</li>
<li>Write queries that compute aggregated values.</li>
<li>Trace the execution of a query that performs aggregation.</li>
<li>Explain how missing data is handled during aggregation.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We now want to calculate ranges and averages for our data. We know
how to select all of the dates from the <code>Daily observations</code>
table:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">date</span> <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<p>but to combine them, we must use an <a href="reference.html#aggregation-function">aggregation function</a> such
as <code>min</code> or <code>max</code>. Each of these functions takes a
set of records as input, and produces a single record as output:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">min</span>(<span class="dt">date</span>) <span class="kw">AS</span> min_date <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>min_date</th>
</tr></thead>
<tbody><tr class="odd">
<td>1871-07-01</td>
</tr></tbody>
</table>
<figure><img src="fig/07.1_select_min_date_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/07.2_select_min_date_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">max</span>(<span class="dt">date</span>) <span class="kw">AS</span> max_date <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>max_date</th>
</tr></thead>
<tbody><tr class="odd">
<td>2021-12-31</td>
</tr></tbody>
</table>
<figure><img src="fig/07.3_max_date_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/07.4_max_date_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p><code>min</code> and <code>max</code> are just two of the aggregation
functions built into SQL. Three others are <code>avg</code>,
<code>count</code>, and <code>sum</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">avg</span>(<span class="fu">value</span>) <span class="kw">AS</span> avg_value <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span>;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>avg_value</th>
</tr></thead>
<tbody><tr class="odd">
<td>24.895614002602183</td>
</tr></tbody>
</table>
<figure><img src="fig/07.5_avg_prcp_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/07.6_avg_prcp_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(element) <span class="kw">AS</span> <span class="fu">count</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span>;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>count</th>
</tr></thead>
<tbody><tr class="odd">
<td>9289244</td>
</tr></tbody>
</table>
<figure><img src="fig/07.7_count_prcp_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/07.8_count_prcp_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">sum</span>(<span class="fu">value</span>) <span class="kw">AS</span> <span class="fu">sum</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span>;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>sum</th>
</tr></thead>
<tbody><tr class="odd">
<td>231261433.0</td>
</tr></tbody>
</table>
<figure><img src="fig/07.9_sum_prcp_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/07.10_sum_prcp_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>We used <code>count(element)</code> here, but we could just as easily
have counted <code>date</code> or any other field in the table, or even
used <code>count(*)</code>, since the function doesn’t care about the
values themselves, just how many values there are.</p>
<p>SQL lets us do several aggregations at once. We can, for example,
find the range of sensible precipitation measurements:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">min</span>(<span class="fu">value</span>) <span class="kw">AS</span> <span class="fu">min</span>, <span class="fu">max</span>(<span class="fu">value</span>) <span class="kw">AS</span> <span class="fu">max</span> <span class="kw">FROM</span> _source_ </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span> <span class="kw">AND</span> <span class="fu">value</span> <span class="op">&gt;=</span> <span class="dv">0</span>;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>min</th>
<th>max</th>
</tr></thead>
<tbody><tr class="odd">
<td>0.0</td>
<td>22860.0</td>
</tr></tbody>
</table>
<figure><img src="fig/07.11_min_max_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/07.12_min_max_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>Another important fact is that when there are no values to aggregate
— for example, where there are no rows satisfying the <code>WHERE</code>
clause — aggregation’s result is “don’t know” rather than zero or some
other arbitrary value:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">max</span>(<span class="fu">value</span>) <span class="kw">AS</span> <span class="fu">max</span>, <span class="fu">min</span>(<span class="fu">value</span>) <span class="kw">AS</span> <span class="fu">min</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'IDK'</span> <span class="kw">AND</span> <span class="fu">value</span> <span class="op">&gt;=</span> <span class="dv">0</span>;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>min</th>
<th>max</th>
</tr></thead>
<tbody><tr class="odd">
<td>-null-</td>
<td>-null-</td>
</tr></tbody>
</table>
<figure><img src="fig/07.13_where_clause_unsatisfied_query.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><figure><img src="fig/07.14_where_clause_unsatisfied_output.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>One final important feature of aggregation functions is that they are
inconsistent with the rest of SQL in a very useful way. If we add two
values, and one of them is null, the result is null. By extension, if we
use <code>sum</code> to add all the values in a set, and any of those
values are null, the result should also be null. It’s much more useful,
though, for aggregation functions to ignore null values and only combine
those that are non-null. This behavior lets us write our queries as:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">min</span>(<span class="dt">date</span>) <span class="kw">AS</span> <span class="fu">min</span> <span class="kw">FROM</span> _source_;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>min</th>
</tr></thead>
<tbody><tr class="odd">
<td>1871-07-01</td>
</tr></tbody>
</table>
<p>instead of always having to filter explicitly:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">min</span>(<span class="dt">date</span>) <span class="kw">AS</span> <span class="fu">min</span> <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> <span class="dt">date</span> <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>min</th>
</tr></thead>
<tbody><tr class="odd">
<td>1871-07-01</td>
</tr></tbody>
</table>
<p>Let’s say that we want to know the average precipitation by date. If
we try the following query, Redivis will throw an error:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">date</span>, <span class="fu">avg</span>(<span class="fu">value</span>) <span class="kw">AS</span> avg_prcp <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span>;</span></code></pre>
</div>
<p>because Redivis doesn’t know which date to return alongside the
average precipitation.</p>
<figure><img src="fig/07.15_combine_raw_aggregate_error.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><p>There are 54,963 unique dates. It’s not reasonable to write 54,963
queries of the form:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">date</span>, <span class="fu">avg</span>(<span class="fu">value</span>) <span class="kw">AS</span> avg_prcp <span class="kw">FROM</span> _source_ </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span> <span class="kw">AND</span> <span class="dt">date</span> <span class="op">=</span> YYYY<span class="op">-</span>MM<span class="op">-</span>DD;</span></code></pre>
</div>
<p>What we need to do is tell the database manager to aggregate the
average precipitation for each date separately using a
<code>GROUP BY</code> clause:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">date</span>, <span class="fu">avg</span>(<span class="fu">value</span>) <span class="kw">AS</span> avg_prcp <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dt">date</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ORDER</span> <span class="kw">by</span> <span class="dt">date</span> <span class="kw">DESC</span>;</span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>date</th>
<th>avg_prcp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2021-12-31</td>
<td>26.154761904761898</td>
</tr>
<tr class="even">
<td>2021-12-30</td>
<td>32.957528957528964</td>
</tr>
<tr class="odd">
<td>2021-12-29</td>
<td>34.042307692307695</td>
</tr>
<tr class="even">
<td>2021-12-28</td>
<td>16.272373540856034</td>
</tr>
</tbody>
</table>
<p><img src="fig/07.16_group_by_date_query.png" id="id" class="class figure" border="5px" alt=""><img src="fig/07.17_group_by_date_output.png" id="id" class="class figure" border="5px" alt=""></p>
<p><code>GROUP BY</code> does exactly what its name implies: groups all
the records with the same value for the specified field together so that
aggregation can process each batch separately.</p>
<p>Just as we can sort by multiple criteria at once, we can also group
by multiple criteria. To get the average reading by scientist and
quantity measured, for example, we just add another field to the
<code>GROUP BY</code> clause:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">date</span>, <span class="dt">time</span>, <span class="fu">avg</span>(<span class="fu">value</span>) <span class="kw">AS</span> avg_prcp <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dt">date</span>, <span class="dt">time</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ORDER</span> <span class="kw">by</span> <span class="dt">date</span> <span class="kw">DESC</span>, <span class="dt">time</span> <span class="kw">ASC</span>;</span></code></pre>
</div>
<table class="table">
<colgroup>
<col width="30%">
<col width="26%">
<col width="42%">
</colgroup>
<thead><tr class="header">
<th>date</th>
<th>time</th>
<th>avg_prcp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2021-12-31</td>
<td>-null-</td>
<td>27.441624365482234</td>
</tr>
<tr class="even">
<td>2021-12-31</td>
<td>0600</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>2021-12-31</td>
<td>0630</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>2021-12-31</td>
<td>0700</td>
<td>8.1818181818181817</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Note that we have added <code>time</code> to the list of fields
displayed, since the results wouldn’t make much sense otherwise.</p>
<p><img src="fig/07.18_group_by_date_time_query.png" id="id" class="class figure" border="5px" alt=""><img src="fig/07.19_group_by_date_time_output.png" id="id" class="class figure" border="5px" alt=""></p>
<p>Let’s go one step further and remove all the entries where we don’t
know what time the measurement was taken:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="dt">date</span>, <span class="dt">time</span>, <span class="fu">avg</span>(<span class="fu">value</span>) <span class="kw">AS</span> avg_prcp <span class="kw">FROM</span> _source_ </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span> <span class="kw">AND</span> <span class="dt">time</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dt">date</span>, <span class="dt">time</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ORDER</span> <span class="kw">by</span> <span class="dt">date</span> <span class="kw">DESC</span>, <span class="dt">time</span> <span class="kw">ASC</span>;</span></code></pre>
</div>
<table class="table">
<colgroup>
<col width="21%">
<col width="18%">
<col width="29%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th>date</th>
<th>time</th>
<th>avg_prcp</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2021-12-31</td>
<td>0600</td>
<td>0.0</td>
<td></td>
</tr>
<tr class="even">
<td>2021-12-31</td>
<td>0630</td>
<td>5.0</td>
<td></td>
</tr>
<tr class="odd">
<td>2021-12-31</td>
<td>0700</td>
<td>8.1818181818181817</td>
<td></td>
</tr>
<tr class="even">
<td>2021-12-31</td>
<td>0800</td>
<td>35.625</td>
<td></td>
</tr>
<tr class="odd">
<td>2021-12-31</td>
<td>1500</td>
<td>0.0</td>
<td></td>
</tr>
</tbody>
</table>
<p><img src="fig/07.20_group_by_date_time_not_null_query.png" id="id" class="class figure" border="5px" alt=""><img src="fig/07.21_group_by_date_time_not_null_output.png" id="id" class="class figure" border="5px" alt=""></p>
<p>Looking more closely, this query:</p>
<ol style="list-style-type: decimal">
<li><p>selected records from the <code>Daily observations</code> table
where the <code>element</code> field is ‘PRCP’ and the <code>time</code>
field was not null;</p></li>
<li><p>grouped those records into <code>date</code> and
<code>time</code> subsets;</p></li>
<li><p>ordered those subsets first by <code>date</code>, and then by
<code>time</code>; and</p></li>
<li><p>calculated the average precipitation of each subset.</p></li>
</ol>
<div id="counting-observation-types" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="counting-observation-types" class="callout-inner">
<h3 class="callout-title">Counting Observation Types<a class="anchor" aria-label="anchor" href="#counting-observation-types"></a>
</h3>
<div class="callout-content">
<p>Using the <code>Daily observations</code> table, find out how many
times each observation type occurred.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> element, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> <span class="fu">count</span> <span class="kw">FROM</span> _source_ </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">by</span> element;</span></code></pre>
</div>
<p><img src="fig/07.22_observation_type_count_query.png" id="id" class="class figure" border="5px" alt=""><img src="fig/07.23_observation_type_count_output.png" id="id" class="class figure" border="5px" alt=""></p>
</div>
</div>
</div>
</div>
<div id="averaging-with-null" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="averaging-with-null" class="callout-inner">
<h3 class="callout-title">Averaging with NULL<a class="anchor" aria-label="anchor" href="#averaging-with-null"></a>
</h3>
<div class="callout-content">
<p>The average of a set of values is the sum of the values divided by
the number of values. Does this mean that the <code>avg</code> function
returns 2.0 or 3.0 when given the values 1.0, <code>null</code>, and
5.0?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>The answer is 3.0. <code>NULL</code> is not a value; it is the
absence of a value. As such it is not included in the calculation.</p>
</div>
</div>
</div>
</div>
<div id="comparing-precipitation-measures-and-average-precipitation" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="comparing-precipitation-measures-and-average-precipitation" class="callout-inner">
<h3 class="callout-title">Comparing Precipitation Measures and Average
Precipitation<a class="anchor" aria-label="anchor" href="#comparing-precipitation-measures-and-average-precipitation"></a>
</h3>
<div class="callout-content">
<p>Write a query that returns the difference between each individual
precipitation measure and the average of all the precipitation
measures.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>We can accomplish this task using sub-queries.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">value</span> <span class="op">-</span> (<span class="kw">SELECT</span> <span class="fu">avg</span>(<span class="fu">value</span>) <span class="kw">AS</span> <span class="fu">avg</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element<span class="op">=</span><span class="st">'PRCP'</span>) <span class="kw">AS</span> difference </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> _source_ <span class="kw">WHERE</span> element <span class="op">=</span> <span class="st">'PRCP'</span>;</span></code></pre>
</div>
<p><img src="fig/07.24_difference_query.png" id="id" class="class figure" border="5px" alt=""><img src="fig/07.25_difference_output.png" id="id" class="class figure" border="5px" alt=""></p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use aggregation functions to combine multiple values.</li>
<li>Aggregation functions ignore <code>null</code> values.</li>
<li>Aggregation happens after filtering.</li>
<li>Use GROUP BY to combine subsets separately.</li>
</ul>
</div>
</div>
</div></section><section id="aio-07-join"><p>Content from <a href="07-join.html">Combining Data</a></p>
<hr>
<p>Last updated on 2023-10-10 |
        
        <a href="https://github.com/swcarpentry/sql-novice-survey/edit/main/episodes/07-join.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I combine data from multiple tables?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the operation of a query that joins two tables.</li>
<li>Explain how to restrict the output of a query containing a join to
only include meaningful combinations of values.</li>
<li>Write queries that join tables on equal keys.</li>
<li>Explain what primary and foreign keys are, and why they are
useful.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In order to submit our data to a web site that aggregates historical
meteorological data, we need to format it as a table with the columns
<code>date</code>, <code>time</code>, <code>name</code>,
<code>state</code>, <code>geopoint</code>, <code>element</code> and
<code>value</code>.</p>
<p>However, <code>name</code>, <code>state</code> and
<code>geopoint</code> are in the <code>Stations</code> table, while
<code>date</code>, <code>time</code>, <code>element</code> and
<code>value</code> are in the <code>Daily observations</code> table. We
need to combine these tables somehow.</p>
<p>The SQL command to do this is <code>JOIN</code>.</p>
<p><code>JOIN</code> creates the <a href="reference.html#cross-product">cross product</a> of two tables.</p>
<p>Let’s look at the skeleton of a <code>JOIN</code> query:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  [variables]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  [<span class="kw">table</span> <span class="dv">1</span>]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  [<span class="kw">table</span> <span class="dv">2</span>] </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  [common field]</span></code></pre>
</div>
<p>We want to join <code>Daily observations</code>
(<code>_source_</code>) with <code>Stations</code>
(<code>stanfordphs.ghcn_daily_weather_data:mg94:v1_2:sample.stations:w0e9</code>).
For clarity, we give our tables the aliases <code>t0</code> and
<code>t1</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  [variables]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  _source_ <span class="kw">AS</span> t0</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  `stanfordphs.ghcn_daily_weather_data<span class="ch">:mg94:v1_2:sample</span>.stations<span class="ch">:w0e9</span>` <span class="kw">AS</span> t1  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  [common field]</span></code></pre>
</div>
<p>Next, we must choose field(s) on which to join our two tables. We
will join our tables <code>ON</code> the <code>id</code> field.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  [variables]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  _source_ <span class="kw">AS</span> t0</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  `stanfordphs.ghcn_daily_weather_data<span class="ch">:mg94:v1_2:sample</span>.stations<span class="ch">:w0e9</span>` <span class="kw">AS</span> t1  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  t0.<span class="kw">id</span> <span class="op">=</span> t1.<span class="kw">id</span></span></code></pre>
</div>
<p>Finally, we select the variables we would like in our output. Notice
that we used <code>Table.field</code> to specify field names in the
output of the join. We do this because tables can have fields with the
same name, and we need to be specific which ones we’re talking about. We
have also given our selected variables more human-friendly names using
the <code>AS</code> operator.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  t0.<span class="kw">id</span> <span class="kw">AS</span> <span class="kw">id</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  t0.<span class="dt">date</span> <span class="kw">AS</span> <span class="dt">date</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  t0.<span class="dt">time</span> <span class="kw">AS</span> <span class="dt">time</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  t0.element <span class="kw">AS</span> element,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  t0.<span class="fu">value</span> <span class="kw">AS</span> <span class="fu">value</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  t1.state <span class="kw">AS</span> state,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  t1.name <span class="kw">AS</span> name,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  t1.geopoint <span class="kw">AS</span> geopoint</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  _source_ <span class="kw">AS</span> t0</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  `stanfordphs.ghcn_daily_weather_data<span class="ch">:mg94:v1_2:sample</span>.stations<span class="ch">:w0e9</span>` <span class="kw">AS</span> t1  </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  t0.<span class="kw">id</span> <span class="op">=</span> t1.<span class="kw">id</span></span></code></pre>
</div>
<p>Here is what our query and output look like in Redivis:</p>
<p><img src="fig/08.1_two_table_join_query.png" id="id" class="class figure" border="5px" alt=""><img src="fig/08.2_two_table_join_output.png" id="id" class="class figure" border="5px" alt=""></p>
<p>If joining two tables is good, joining many tables must be better. In
fact, we can join any number of tables simply by adding more
<code>JOIN</code> clauses to our query, and more <code>ON</code> tests
to filter out combinations of records that don’t make sense:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  t0.<span class="kw">id</span> <span class="kw">AS</span> <span class="kw">id</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  t0.<span class="dt">date</span> <span class="kw">AS</span> <span class="dt">date</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  t0.<span class="dt">time</span> <span class="kw">AS</span> <span class="dt">time</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  t0.element <span class="kw">AS</span> element,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  t0.<span class="fu">value</span> <span class="kw">AS</span> <span class="fu">value</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  t1.<span class="kw">id</span> <span class="kw">AS</span> foreign_id,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  t1.state <span class="kw">AS</span> state_code,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  t1.name <span class="kw">AS</span> name,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  t1.geopoint <span class="kw">AS</span> geopoint,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  t2.name <span class="kw">AS</span> state_name</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  _source_ <span class="kw">AS</span> t0</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  `stanfordphs.ghcn_daily_weather_data<span class="ch">:mg94:v1_2:sample</span>.stations<span class="ch">:w0e9</span>` <span class="kw">AS</span> t1  </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  t0.<span class="kw">id</span> <span class="op">=</span> t1.<span class="kw">id</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  `stanfordphs.ghcn_daily_weather_data<span class="ch">:mg94:v1_2</span>.states<span class="ch">:akcp</span>` <span class="kw">as</span> t2</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  t1.state <span class="op">=</span> t2.code</span></code></pre>
</div>
<p><img src="fig/08.3_double_join_query.png" id="id" class="class figure" border="5px" alt=""><img src="fig/08.4_double_join_output.png" id="id" class="class figure" border="5px" alt=""></p>
<p>In the above query, we join <code>Daily observations</code> with
<code>Stations</code> with <code>States</code>. Our output contains some
(but not all) of the variables included in each source table. Notice
that for the second <code>JOIN</code>, we use <code>LEFT JOIN</code>. By
doing this, we are asking the database:</p>
<ol style="list-style-type: decimal">
<li><p>Join on <code>Stations.state</code> = <code>States.code</code>
(these should both be two-letter abbreviations for state name)</p></li>
<li><p>If a value of <code>Stations.state</code> does not have any
matches among <code>States.code</code>, return the value
<code>Stations.state</code> and <code>States.code</code> as
<code>null</code>.</p></li>
</ol>
<figure><img src="fig/08.5_left_join_outcome.png" id="id" class="class figure mx-auto d-block" border="5px" alt=""></figure><div id="types-of-joins" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="types-of-joins" class="callout-inner">
<h3 class="callout-title">Types of JOINS<a class="anchor" aria-label="anchor" href="#types-of-joins"></a>
</h3>
<div class="callout-content">
<p>There are several variations of <code>JOIN</code>. For more
information, check out the <a href="https://www.w3schools.com/sql/sql_join.asp" class="external-link">W3 Schools SQL
Tutorial</a>. Note that a plain <code>JOIN</code> is equivalent to
<code>INNER JOIN</code>. A good visual explanation of joins can be <a href="https://sql-joins.leopard.in.ua/" class="external-link">found here</a></p>
</div>
</div>
</div>
<p>We can tell which records from <code>Daily observations</code>,
<code>Stations</code> and <code>States</code> correspond with each other
because those tables contain <a href="reference.html#primary-key">primary keys</a> and <a href="reference.html#foreign-key">foreign keys</a>. A primary key is a
value, or combination of values, that uniquely identifies each record in
a table. A foreign key is a value (or combination of values) from one
table that identifies a unique record in another table. Another way of
saying this is that a foreign key is the primary key of one table that
appears in some other table.</p>
<p>Most database designers believe that every table should have a
well-defined primary key. They also believe that this key should be
separate from the data itself, so that if we ever need to change the
data, we only need to make one change in one place.</p>
<div id="expanding-on-the-inventory" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="expanding-on-the-inventory" class="callout-inner">
<h3 class="callout-title">Expanding on the Inventory<a class="anchor" aria-label="anchor" href="#expanding-on-the-inventory"></a>
</h3>
<div class="callout-content">
<p>The <code>Inventory</code> table gives us information about
observations at given stations. Write a query that returns this
information, as well as the name and state of the station.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  t0.<span class="kw">id</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  t0.latitude,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  t0.longitude,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  t0.element,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  t0.firstyear,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  t0.lastyear,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  t1.name,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  t1.state</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  _source_ <span class="kw">AS</span> t0</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  `stanfordphs.ghcn_daily_weather_data<span class="ch">:mg94:v1_2:sample</span>.stations<span class="ch">:w0e9</span>` <span class="kw">AS</span> t1  </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  t0.<span class="kw">id</span> <span class="op">=</span> t1.<span class="kw">id</span></span></code></pre>
</div>
<p><img src="fig/08.6_join_inventory_stations_query.png" id="id" class="class figure" border="5px" alt=""><img src="fig/08.7_join_inventory_stations_output.png" id="id" class="class figure" border="5px" alt=""></p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use JOIN to combine data from two tables.</li>
<li>Use table.field notation to refer to fields when doing joins.</li>
<li>Every fact should be represented in a database exactly once.</li>
<li>A join produces all combinations of records from one table with
records from another.</li>
<li>A primary key is a field (or set of fields) whose values uniquely
identify the records in a table.</li>
<li>A foreign key is a field (or set of fields) in one table whose
values are a primary key in another table.</li>
<li>We can eliminate meaningless combinations of records by matching
primary keys and foreign keys between tables.</li>
<li>The most common join condition is matching keys.</li>
</ul>
</div>
</div>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/swcarpentry/sql-novice-survey/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/swcarpentry/sql-novice-survey/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/swcarpentry/sql-novice-survey/" class="external-link">Source</a></p>
				<p><a href="https://github.com/swcarpentry/sql-novice-survey/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.2" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.3" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://swcarpentry.github.io/sql-novice-survey/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://swcarpentry.github.io/sql-novice-survey/aio.html",
  "identifier": "https://swcarpentry.github.io/sql-novice-survey/aio.html",
  "dateCreated": "2014-11-21",
  "dateModified": "2024-02-13",
  "datePublished": "2024-02-13"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

